<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>backup | pgBackRest</title>
    <meta name="description" content="Reliable PostgreSQL Backup &amp; Restore">
    <link rel="icon" href="/pgbackrest-docs/logo.png">
    
    <link rel="preload" href="/pgbackrest-docs/assets/css/0.styles.18edf712.css" as="style"><link rel="preload" href="/pgbackrest-docs/assets/js/app.01ebea85.js" as="script"><link rel="preload" href="/pgbackrest-docs/assets/js/7.58324044.js" as="script"><link rel="prefetch" href="/pgbackrest-docs/assets/js/26.e11cc072.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/2.ea010887.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/3.b7507089.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/4.cfc39c6d.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/5.6b11616c.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/6.df92328a.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/8.c87957ea.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/9.0fb232f6.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/10.972bbafb.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/11.e78eb127.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/12.5928bd53.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/13.1c12197c.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/14.d84f628c.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/15.4adcb884.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/16.ef3b7049.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/17.9d3117d9.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/18.0bcae378.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/19.295fa193.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/20.94847527.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/21.b5e7b8b5.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/22.d07ad4dd.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/23.77d36072.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/24.6b6691b4.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/25.f9425e67.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/27.78d9feea.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/28.1f99e16d.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/29.28bb7045.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/30.cff46cbe.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/31.47660e90.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/32.9df22cac.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/33.37935b34.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/34.9706bcdc.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/35.5ec6e936.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/36.996e8c9b.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/37.4718e56d.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/38.b3445822.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/39.c3ad3059.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/40.567d1aff.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/41.d0b20dd8.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/42.663bd5fd.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/43.d28dcd20.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/44.2dd273bd.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/45.bf622f74.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/46.0d093936.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/47.4a1a0f05.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/48.808678bd.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/49.18e9d1eb.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/50.fa7ae22a.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/51.63339b12.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/52.8b737e70.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/53.974f5c76.js"><link rel="prefetch" href="/pgbackrest-docs/assets/js/54.9d3ce5c2.js">
    <link rel="stylesheet" href="/pgbackrest-docs/assets/css/0.styles.18edf712.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/pgbackrest-docs/" class="home-link router-link-active"><!----><span class="site-name">
      pgBackRest
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/pgbackrest-docs/guide/" class="nav-link">Guide</a></div><div class="nav-item"><a href="/pgbackrest-docs/releases/" class="nav-link">Releases</a></div><div class="nav-item"><a href="/pgbackrest-docs/config/" class="nav-link">Configuration</a></div><div class="nav-item"><a href="/pgbackrest-docs/commands/" class="nav-link router-link-active">Commands</a></div><a href="https://github.com/pgbackrest/pgbackrest" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/pgbackrest-docs/guide/" class="nav-link">Guide</a></div><div class="nav-item"><a href="/pgbackrest-docs/releases/" class="nav-link">Releases</a></div><div class="nav-item"><a href="/pgbackrest-docs/config/" class="nav-link">Configuration</a></div><div class="nav-item"><a href="/pgbackrest-docs/commands/" class="nav-link router-link-active">Commands</a></div><a href="https://github.com/pgbackrest/pgbackrest" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Commands</span><!----></p><ul class="sidebar-group-items"><li><a href="/pgbackrest-docs/commands/" class="sidebar-link">Introduction</a></li><li><a href="/pgbackrest-docs/commands/general_options.html" class="sidebar-link">General Options</a></li><li><a href="/pgbackrest-docs/commands/log_options.html" class="sidebar-link">Log Options</a></li><li><a href="/pgbackrest-docs/commands/repository_options.html" class="sidebar-link">Repository Options</a></li><li><a href="/pgbackrest-docs/commands/stanza_options.html" class="sidebar-link">Stanza Options</a></li><li><a href="/pgbackrest-docs/commands/archive_get.html" class="sidebar-link">archive-get</a></li><li><a href="/pgbackrest-docs/commands/archive_push.html" class="sidebar-link">archive-push</a></li><li><a href="/pgbackrest-docs/commands/backup.html" class="active sidebar-link">backup</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pgbackrest-docs/commands/backup.html#archive-check" class="sidebar-link">--archive-check</a></li><li class="sidebar-sub-header"><a href="/pgbackrest-docs/commands/backup.html#archive-copy" class="sidebar-link">--archive-copy</a></li><li class="sidebar-sub-header"><a href="/pgbackrest-docs/commands/backup.html#archive-timeout" class="sidebar-link">--archive-timeout</a></li><li class="sidebar-sub-header"><a href="/pgbackrest-docs/commands/backup.html#backup-standby" class="sidebar-link">--backup-standby</a></li><li class="sidebar-sub-header"><a href="/pgbackrest-docs/commands/backup.html#checksum-page" class="sidebar-link">--checksum-page</a></li><li class="sidebar-sub-header"><a href="/pgbackrest-docs/commands/backup.html#force" class="sidebar-link">--force</a></li><li class="sidebar-sub-header"><a href="/pgbackrest-docs/commands/backup.html#manifest-save-threshold" class="sidebar-link">--manifest-save-threshold</a></li><li class="sidebar-sub-header"><a href="/pgbackrest-docs/commands/backup.html#online" class="sidebar-link">--online</a></li><li class="sidebar-sub-header"><a href="/pgbackrest-docs/commands/backup.html#resume" class="sidebar-link">--resume</a></li><li class="sidebar-sub-header"><a href="/pgbackrest-docs/commands/backup.html#start-fast" class="sidebar-link">--start-fast</a></li><li class="sidebar-sub-header"><a href="/pgbackrest-docs/commands/backup.html#stop-auto" class="sidebar-link">--stop-auto</a></li><li class="sidebar-sub-header"><a href="/pgbackrest-docs/commands/backup.html#type" class="sidebar-link">--type</a></li></ul></li><li><a href="/pgbackrest-docs/commands/check.html" class="sidebar-link">check</a></li><li><a href="/pgbackrest-docs/commands/expire.html" class="sidebar-link">expire</a></li><li><a href="/pgbackrest-docs/commands/info.html" class="sidebar-link">info</a></li><li><a href="/pgbackrest-docs/commands/restore.html" class="sidebar-link">restore</a></li><li><a href="/pgbackrest-docs/commands/stanza_create.html" class="sidebar-link">stanza-create</a></li><li><a href="/pgbackrest-docs/commands/stanza_delete.html" class="sidebar-link">stanza-delete</a></li><li><a href="/pgbackrest-docs/commands/stanza_upgrade.html" class="sidebar-link">stanza-upgrade</a></li><li><a href="/pgbackrest-docs/commands/start.html" class="sidebar-link">start</a></li><li><a href="/pgbackrest-docs/commands/stop.html" class="sidebar-link">stop</a></li><li><a href="/pgbackrest-docs/commands/help.html" class="sidebar-link">help</a></li><li><a href="/pgbackrest-docs/commands/version.html" class="sidebar-link">version</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="backup"><a href="#backup" aria-hidden="true" class="header-anchor">#</a> backup</h1><p>pgBackRest does not have a built-in scheduler so it's best to run it from cron or some other scheduling mechanism.</p><h2 id="archive-check"><a href="#archive-check" aria-hidden="true" class="header-anchor">#</a> --archive-check</h2><p>Check that WAL segments are in the archive before backup completes.</p><p>Checks that all WAL segments required to make the backup consistent are present in the WAL archive. It's a good idea to leave this as the default unless you are using another method for archiving.</p><p>This option must be enabled if archive-copy is enabled.</p><div class="language- extra-class"><pre class="language-text"><code>default: y
example: --no-archive-check
</code></pre></div><h2 id="archive-copy"><a href="#archive-copy" aria-hidden="true" class="header-anchor">#</a> --archive-copy</h2><p>Copy WAL segments needed for consistency to the backup.</p><p>This slightly paranoid option protects against corruption in the WAL segment archive by storing the WAL segments required for consistency directly in the backup. WAL segments are still stored in the archive so this option will use additional space.</p><p>On restore, the WAL segments will be present in <code>pg_xlog/pg_wal</code> and PostgreSQL will use them in preference to calling the <code>restore_command</code>.</p><p>The <code>archive-check</code> option must be enabled if <code>archive-copy</code> is enabled.</p><div class="language- extra-class"><pre class="language-text"><code>default: n
example: --archive-copy
</code></pre></div><h2 id="archive-timeout"><a href="#archive-timeout" aria-hidden="true" class="header-anchor">#</a> --archive-timeout</h2><p>Archive timeout.</p><p>Set maximum time, in seconds, to wait for each WAL segment to reach the pgBackRest archive repository. The timeout applies to the check and backup commands when waiting for WAL segments required for backup consistency to be archived.</p><div class="language- extra-class"><pre class="language-text"><code>default: 60
allowed: 0.1-86400
example: --archive-timeout=30
</code></pre></div><h2 id="backup-standby"><a href="#backup-standby" aria-hidden="true" class="header-anchor">#</a> --backup-standby</h2><p>Backup from the standby cluster.</p><p>Enable backup from standby to reduce load on the primary cluster. This option requires that both the primary and standby hosts be configured.</p><div class="language- extra-class"><pre class="language-text"><code>default: n
example: --backup-standby
</code></pre></div><h2 id="checksum-page"><a href="#checksum-page" aria-hidden="true" class="header-anchor">#</a> --checksum-page</h2><p>Validate data page checksums.</p><p>Directs pgBackRest to validate all data page checksums while backing up a cluster. This option is automatically enabled when data page checksums are enabled on the cluster.</p><p>Failures in checksum validation will not abort a backup. Rather, warnings will be emitted in the log (and to the console with default settings) and the list of invalid pages will be stored in the backup manifest.</p><div class="language- extra-class"><pre class="language-text"><code>example: --no-checksum-page
</code></pre></div><h2 id="force"><a href="#force" aria-hidden="true" class="header-anchor">#</a> --force</h2><p>Force an offline backup.</p><p>When used with <code>--no-start-stop</code> a backup will be run even if pgBackRest thinks that PostgreSQL is running. This option should be used with extreme care as it will likely result in a bad backup.</p><p>There are some scenarios where a backup might still be desirable under these conditions. For example, if a server crashes and the database cluster volume can only be mounted read-only, it would be a good idea to take a backup even if postmaster.pid is present. In this case it would be better to revert to the prior backup and replay WAL, but possibly there is a very important transaction in a WAL segment that did not get archived.</p><div class="language- extra-class"><pre class="language-text"><code>default: n
example: --force
</code></pre></div><h2 id="manifest-save-threshold"><a href="#manifest-save-threshold" aria-hidden="true" class="header-anchor">#</a> --manifest-save-threshold</h2><p>Manifest save threshold during backup.</p><p>Defines how often the manifest will be saved during a backup. Saving the manifest is important because it stores the checksums and allows the resume function to work efficiently. The actual threshold used is 1% of the backup size or <code>manifest-save-threshold</code>, whichever is greater.</p><p>Size can be entered in bytes (default) or KB, MB, GB, TB, or PB where the multiplier is a power of 1024.</p><div class="language- extra-class"><pre class="language-text"><code>default: 1073741824
allowed: 1-1099511627776
example: --manifest-save-threshold=5G
</code></pre></div><h2 id="online"><a href="#online" aria-hidden="true" class="header-anchor">#</a> --online</h2><p>Perform an online backup.</p><p>Specifying <code>--no-online</code> prevents pgBackRest from running <code>pg_start_backup()</code> and <code>pg_stop_backup()</code> on the database cluster. In order for this to work PostgreSQL should be shut down and pgBackRest will generate an error if it is not.</p><p>The purpose of this option is to allow offline backups. The <code>pg_xlog/pg_wal</code> directory is copied as-is and archive-check is automatically disabled for the backup.</p><div class="language- extra-class"><pre class="language-text"><code>default: y
example: --no-online
</code></pre></div><h2 id="resume"><a href="#resume" aria-hidden="true" class="header-anchor">#</a> --resume</h2><p>Allow resume of failed backup.</p><p>Defines whether the resume feature is enabled. Resume can greatly reduce the amount of time required to run a backup after a previous backup of the same type has failed. It adds complexity, however, so it may be desirable to disable in environments that do not require the feature.</p><div class="language- extra-class"><pre class="language-text"><code>default: y
example: --no-resume
</code></pre></div><h2 id="start-fast"><a href="#start-fast" aria-hidden="true" class="header-anchor">#</a> --start-fast</h2><p>Force a checkpoint to start backup quickly.</p><p>Forces a checkpoint (by passing y to the fast parameter of <code>pg_start_backup()</code>) so the backup begins immediately. Otherwise the backup will start after the next regular checkpoint.</p><p>This feature only works in PostgreSQL &gt;= 8.4.</p><div class="language- extra-class"><pre class="language-text"><code>default: n
example: --start-fast
</code></pre></div><h2 id="stop-auto"><a href="#stop-auto" aria-hidden="true" class="header-anchor">#</a> --stop-auto</h2><p>Stop prior failed backup on new backup.</p><p>This will only be done if an exclusive advisory lock can be acquired to demonstrate that the prior failed backup process has really stopped.</p><p>This feature relies on <code>pg_is_in_backup()</code> so only works on PostgreSQL &gt;= 9.3.</p><p>The setting is disabled by default because it assumes that pgBackRest is the only process doing exclusive online backups. It depends on an advisory lock that only pgBackRest sets so it may abort other processes that do exclusive online backups. Note that base_backup and pg_dump are safe to use with this setting because they do not call <code>pg_start_backup()</code> so are not exclusive.</p><div class="language- extra-class"><pre class="language-text"><code>default: n
example: --stop-auto
</code></pre></div><h2 id="type"><a href="#type" aria-hidden="true" class="header-anchor">#</a> --type</h2><p>Backup type.</p><p>The following backup types are supported:</p><ul><li><code>full</code> - all database cluster files will be copied and there will be no dependencies on previous backups.</li><li><code>incr</code> - incremental from the last successful backup.</li><li><code>diff</code> - like an incremental backup but always based on the last full backup.</li></ul><div class="language- extra-class"><pre class="language-text"><code>default: incr
example: --type=full
</code></pre></div></div><div class="page-edit"><div class="edit-link"><a href="https://github.com/pgbackrest/pgbackrest/edit/master/commands/backup.md" target="_blank" rel="noopener noreferrer">Edit this page</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><!----></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/pgbackrest-docs/commands/archive_push.html" class="prev">
          archive-push
        </a></span><span class="next"><a href="/pgbackrest-docs/commands/check.html">
          check
        </a> →
      </span></p></div></div></div></div>
    <script src="/pgbackrest-docs/assets/js/7.58324044.js" defer></script><script src="/pgbackrest-docs/assets/js/app.01ebea85.js" defer></script>
  </body>
</html>

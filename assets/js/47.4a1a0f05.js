(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{153:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),a("p",[t._v("pgBackRest supports storing repositories in "),a("a",{attrs:{href:"https://aws.amazon.com/s3/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Amazon S3"),a("OutboundLink")],1),t._v(". The bucket used to store the repository must be created in advance — pgBackRest will not do it automatically.")]),t._m(1),a("p",[t._v("Commands are run exactly as if the repository were stored on a local disk.")]),t._m(2),a("p",[t._v("File creation time in S3 is relatively slow so commands benefit by increasing process-max to parallelize file creation.")]),t._m(3)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"aws-s3-support"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#aws-s3-support","aria-hidden":"true"}},[this._v("#")]),this._v(" AWS S3 Support")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-ini extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[t._v("# pg-primary:/etc/pgbackrest/pgbackrest.conf ⇒ Configure S3\n"),a("span",{attrs:{class:"token selector"}},[t._v("[demo]")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("pg1-path")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("/var/lib/postgresql/9.4/demo")]),t._v("\n\n"),a("span",{attrs:{class:"token selector"}},[t._v("[global]")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("process-max")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("4")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("repo1-cipher-type")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("none")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("repo1-path")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("/")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("repo1-retention-diff")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("2")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("repo1-retention-full")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("2")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("repo1-s3-bucket")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("demo-bucket")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("repo1-s3-endpoint")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("s3.amazonaws.com")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("repo1-s3-key")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("accessKey1")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("repo1-s3-key-secret")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("verySecretKey1")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("repo1-s3-region")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("us-east-1")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("repo1-s3-verify-ssl")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("n")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("repo1-type")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("s3")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("start-fast")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("y")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("stop-auto")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("y")]),t._v("\n\n"),a("span",{attrs:{class:"token selector"}},[t._v("[global:archive-push]")]),t._v("\n"),a("span",{attrs:{class:"token constant"}},[t._v("compress-level")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),t._v("3")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# pg-primary ⇒ Create the stanza")]),t._v("\n"),a("span",{attrs:{class:"token function"}},[t._v("sudo")]),t._v(" -u postgres pgbackrest --stanza"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("demo --log-level-console"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("info stanza-create\nP00   INFO: stanza-create "),a("span",{attrs:{class:"token function"}},[t._v("command")]),t._v(" begin 2.02: --log-level-console"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("info --log-level-stderr"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("off --no-log-timestamp --pg1-path"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/lib/postgresql/9.4/demo --repo1-cipher-type"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("none --repo1-path"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("/ --repo1-s3-bucket"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("demo-bucket --repo1-s3-endpoint"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("s3.amazonaws.com --repo1-s3-key"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" --repo1-s3-key-secret"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" --repo1-s3-region"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("us-east-1 --no-repo1-s3-verify-ssl --repo1-type"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("s3 --stanza"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("demo\nP00   INFO: stanza-create "),a("span",{attrs:{class:"token function"}},[t._v("command")]),t._v(" end: completed successfully\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# pg-primary ⇒ Backup the demo cluster")]),t._v("\n"),a("span",{attrs:{class:"token function"}},[t._v("sudo")]),t._v(" -u postgres pgbackrest --stanza"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("demo \\\n       --log-level-console"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("info backup\nP00   INFO: backup "),a("span",{attrs:{class:"token function"}},[t._v("command")]),t._v(" begin 2.02: --log-level-console"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("info --log-level-stderr"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("off --no-log-timestamp --pg1-path"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/lib/postgresql/9.4/demo --process-max"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("4 --repo1-cipher-type"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("none --repo1-path"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("/ --repo1-retention-diff"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("2 --repo1-retention-full"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("2 --repo1-s3-bucket"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("demo-bucket --repo1-s3-endpoint"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("s3.amazonaws.com --repo1-s3-key"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" --repo1-s3-key-secret"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" --repo1-s3-region"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("us-east-1 --no-repo1-s3-verify-ssl --repo1-type"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("s3 --stanza"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("demo --start-fast --stop-auto\nP00   WARN: no prior backup exists, incr backup has been changed to full\nP00   INFO: execute exclusive pg_start_backup"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" with label "),a("span",{attrs:{class:"token string"}},[t._v('"pgBackRest backup started at 2018-05-06 15:18:34"')]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" backup begins after the requested immediate checkpoint completes\nP00   INFO: backup start archive "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" 00000007000000000000001B, lsn "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" 0/1B000028\n       "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("filtered 995 lines of output"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nP01   INFO: backup "),a("span",{attrs:{class:"token function"}},[t._v("file")]),t._v(" /var/lib/postgresql/9.4/demo/base/1/11895 "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0B, 100%"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nP03   INFO: backup "),a("span",{attrs:{class:"token function"}},[t._v("file")]),t._v(" /var/lib/postgresql/9.4/demo/base/1/11885 "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0B, 100%"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nP00   INFO: full backup size "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" 25.5MB\nP00   INFO: execute exclusive pg_stop_backup"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" and "),a("span",{attrs:{class:"token function"}},[t._v("wait")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" all WAL segments to archive\nP00   INFO: backup stop archive "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" 00000007000000000000001B, lsn "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" 0/1B000128\n       "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("filtered 4 lines of output"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])}],!1,null,null,null);s.default=e.exports}}]);
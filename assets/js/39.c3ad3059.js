(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{161:function(s,t,a){"use strict";a.r(t);var n=a(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"installation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installation","aria-hidden":"true"}},[s._v("#")]),s._v(" Installation")]),a("p",[s._v("A new host named "),a("code",[s._v("pg1")]),s._v(" is created to contain the demo cluster and run pgBackRest examples.\npgBackRest supports 32-bit distributions that build Perl with 64-bit integer support.")]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[s._v("# pg-primary ⇒ Check for 64-bit integers")]),s._v("\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" -u postgres perl -V "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("grep")]),s._v(" USE_64_BIT_INT USE_64_BIT_ALL USE_64_BIT_INT USE_ITHREADS\n")])])]),a("p",[s._v("If pgBackRest has been installed before it's best to be sure that no prior copies of it are still installed. Depending on how old the version of pgBackRest is it may have been installed in a few different locations. The following commands will remove all prior versions of pgBackRest.")]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[s._v("# pg-primary ⇒ Remove prior pgBackRest installations")]),s._v("\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f /usr/bin/pgbackrest\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f /usr/bin/pg_backrest\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /usr/lib/perl5/BackRest\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /usr/share/perl5/BackRest\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /usr/lib/perl5/pgBackRest\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /usr/share/perl5/pgBackRest\n")])])]),a("p",[s._v("pgBackRest is written in Perl which is included with Debian/Ubuntu by default. Some additional modules must also be installed but they are available as standard packages.")]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[s._v("# pg-primary ⇒ Install required Perl packages")]),s._v("\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("install")]),s._v(" libdbd-pg-perl libio-socket-ssl-perl libxml-libxml-perl\n")])])]),a("p",[s._v("Debian/Ubuntu packages for pgBackRest are available at apt.postgresql.org. If they are not provided for your distribution/version it is easy to download the source and install manually.")]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[s._v("# pg-primary ⇒ Download version 2.02 of pgBackRest")]),s._v("\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("wget")]),s._v(" -q -O - \\\n       https://github.com/pgbackrest/pgbackrest/archive/release/2.02.tar.gz "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" \\\n       "),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("tar")]),s._v(" zx -C /root\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[s._v("# pg-primary ⇒ Install pgBackRest")]),s._v("\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r /root/pgbackrest-release-2.02/lib/pgBackRest \\\n       /usr/share/perl5\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("find")]),s._v(" /usr/share/perl5/pgBackRest -type f -exec "),a("span",{attrs:{class:"token function"}},[s._v("chmod")]),s._v(" 644 "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" +\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("find")]),s._v(" /usr/share/perl5/pgBackRest -type d -exec "),a("span",{attrs:{class:"token function"}},[s._v("chmod")]),s._v(" 755 "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" +\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -m 770 /var/log/pgbackrest\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("chown")]),s._v(" postgres:postgres /var/log/pgbackrest\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /etc/pgbackrest\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /etc/pgbackrest/conf.d\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("touch")]),s._v(" /etc/pgbackrest/pgbackrest.conf\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("chmod")]),s._v(" 640 /etc/pgbackrest/pgbackrest.conf\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("chown")]),s._v(" postgres:postgres /etc/pgbackrest/pgbackrest.conf\n")])])]),a("p",[s._v("pgBackRest requires a companion C library that enhances performance and enables the "),a("code",[s._v("checksum-page")]),s._v(" option and encryption. Pre-built packages are generally a better option than building the C library manually but the steps required are given below for completeness. Depending on the distribution a number of packages may be required which will not be enumerated here.")]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[s._v("# pg-primary ⇒ Build and Install C Library")]),s._v("\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" sh -c "),a("span",{attrs:{class:"token string"}},[s._v("'cd /root/pgbackrest-release-2.02/libc && \\\n       perl Makefile.PL INSTALLMAN1DIR=none INSTALLMAN3DIR=none'")]),s._v("\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("make")]),s._v(" -C /root/pgbackrest-release-2.02/libc "),a("span",{attrs:{class:"token function"}},[s._v("test")]),s._v("\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("make")]),s._v(" -C /root/pgbackrest-release-2.02/libc "),a("span",{attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])])]),a("p",[s._v("Although most of pgBackRest is written in Perl, the main executable is written in C. This allows certain time-critical commands (like async archive-push) to run more quickly.")]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[s._v("# pg-primary ⇒ Build and Install Binary")]),s._v("\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("make")]),s._v(" -C /root/pgbackrest-release-2.02/src\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("make")]),s._v(" -C /root/pgbackrest-release-2.02/src "),a("span",{attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])])]),a("p",[s._v("pgBackRest should now be properly installed but it is best to check. If any dependencies were missed then you will get an error when running pgBackRest from the command line.")]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[s._v("# pg-primary ⇒ Make sure the installation worked")]),s._v("\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" -u postgres pgbackrest\npgBackRest 2.02 - General "),a("span",{attrs:{class:"token function"}},[s._v("help")]),s._v("\n\nUsage:\n    pgbackrest "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nCommands:\n    archive-get     Get a WAL segment from the archive.\n    archive-push    Push a WAL segment to the archive.\n    backup          Backup a database cluster.\n    check           Check the configuration.\n    expire          Expire backups that exceed retention.\n    "),a("span",{attrs:{class:"token function"}},[s._v("help")]),s._v("            Get help.\n    info            Retrieve information about backups.\n    restore         Restore a database cluster.\n    stanza-create   Create the required stanza data.\n    stanza-delete   Delete a stanza.\n    stanza-upgrade  Upgrade a stanza.\n    start           Allow pgBackRest processes to run.\n    stop            Stop pgBackRest processes from running.\n    version         Get version.\n\nUse "),a("span",{attrs:{class:"token string"}},[s._v("'pgbackrest help [command]'")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("more")]),s._v(" information.\n")])])])])}],!1,null,null,null);t.default=e.exports}}]);